<%# Configuration for all pickers  -%>
<% css_class ||= 'ajaxPicker' -%>
<% action ||= 'autocomplete'.html_safe -%>
<% fields_for_object ||= nil -%>
<% object_name ||= controller.humanize.downcase.singularize.html_safe.gsub(/\//, '') -%>
<% send_select ||= false %>

<% url = url_for({
                     controller: controller,
                     action: action,
                     tag_id: tag_id,
                     method: "#{object}[#{method}]",
                     escape: false})

   begin # allow user to specify grammatically correct placeholder if he goes to the effort
     place_holder = placeholder
   rescue NameError
    place_holder = "Select a #{object_name}"
   end
-%>

<input autocomplete="off"
       title="Find and select a <%= object_name -%>. You must click or tab off a row to choose the item."
       placeholder="<%= place_holder -%>"
       class="mx-autocomplete <%= css_class -%>"
       id="<%= tag_id %>"
       data-send-select="<%= send_select %>"
       data-mx-autocomplete-url="<%= url %>"
       data-mx-method="<%= "#{object}[#{method}]" %>"
       <%= ((size ||= nil).nil? ? 'style="width:98%;"' : "size=\"#{size}\"").html_safe -%>
       type="text"
       value="<%= display -%>"
/>

<% if fields_for_object -%>
    <%= fields_for_object.hidden_field(method, id: "#{tag_id}_hidden_value") -%>
<% else %>
    <%= hidden_field(object, method, id: "#{tag_id}_hidden_value") -%>
<% end %>
